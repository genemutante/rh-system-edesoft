<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o de Colaboradores | Enterprise</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/estilos-treinamentos/cadastro-style.css">
    <script type="module" src="/scripts-treinamentos/cadastro-script.js"></script>
    <script src="../scripts-treinamentos/module-guard.js"></script>
    
    <style>
        /* =========================================================
           LAYOUT 100VH (TELA √öNICA FIXA)
           ========================================================= */
        html, body {
            height: 100%; margin: 0; padding: 0;
            overflow: hidden; /* Trava a rolagem da p√°gina inteira */
            display: flex; flex-direction: column;
            background-color: #f1f5f9;
        }

        /* 1. Ajuste do Header para ficar fixo */
/* Aplicar na 002-cadastro-de-colaborador.html para ficar igual √† 001 */
.top-bar {
    height: 56px !important; /* Altura exata da barra 001 */
    background-color: #ffffff !important;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 1.25rem !important; /* Padding lateral levemente menor */
    border-bottom: 1px solid #e2e8f0;
    flex-shrink: 0;
}

.top-bar h1 {
    font-size: 1.25rem;
    font-weight: 600;
    color: #ffffff; /* Letra Branca */
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

/* Ajuste para os bot√µes que ficam dentro da barra (como o de voltar) */
.top-bar .btn-back {
    color: #ffffff;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: transparent;
}

.top-bar .btn-back:hover {
    background: rgba(255, 255, 255, 0.1);
}

        /* 2. Container Principal Flex√≠vel */
        .container {
            flex: 1; /* Ocupa o resto da altura */
            display: flex; flex-direction: column;
            padding: 15px 20px 0 20px; /* Margens internas */
            overflow: hidden; /* O scroll ser√° nos filhos */
            max-width: 100%;
        }

        /* 3. √Årea da Tabela com Scroll Independente */
        #viewList {
            display: flex; flex-direction: column;
            height: 100%; overflow: hidden;
        }

        .table-container {
            flex: 1; /* Cresce para ocupar espa√ßo */
            overflow: hidden; /* Scroll fica na .table-scroll-area */
            margin-bottom: 20px;
            background: #fff;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            display: flex; flex-direction: column;
        }

        .table-scroll-area {
            flex: 1;
            overflow-y: auto; /* Rolagem vertical aqui */
            overflow-x: auto;
        }

        /* =========================================================
           BADGE DE SEGURAN√áA & UI
           ========================================================= */
        .admin-only { display: none !important; }
        body.is-admin .admin-only { display: inline-flex !important; }
        body.is-admin button.btn-primary-glow.admin-only { display: flex !important; }

        /* Badge no Cabe√ßalho */
/* Ajuste do Modo Leitura para n√£o colidirem as cores */
.viewer-badge {
    display: none; 
    align-items: center; 
    gap: 6px;
    background-color: #f1f5f9; 
    color: #64748b; 
    border: 1px solid #e2e8f0;
    font-size: 11px; 
    font-weight: 600; 
    padding: 4px 12px; 
    border-radius: 100px;
    margin-left: 16px;
}

/* Ajuste do Badge para n√£o empurrar a altura da barra */
.viewer-badge {
    padding: 2px 8px !important;
    font-size: 10px !important;
    margin-left: 12px;
}
		
        .viewer-badge svg { width: 14px; height: 14px; stroke-width: 2; }
        @keyframes fadeIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }

        /* =========================================================
           √çCONES DA TABELA (SVG CLEAN)
           ========================================================= */
        .btn-icon-action {
            width: 30px; height: 30px; 
            padding: 0; border-radius: 6px;
            border: 1px solid #e2e8f0; background: #fff;
            color: #64748b; transition: all 0.2s;
            display: inline-flex; align-items: center; justify-content: center;
            cursor: pointer; margin-left: 4px;
        }
        .btn-icon-action svg { width: 15px; height: 15px; stroke-width: 2; }

        /* Cores de Hover */
        .btn-icon-action:hover { border-color: #cbd5e1; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .btn-icon-action.action-view:hover { color: #3b82f6; background: #eff6ff; border-color: #bfdbfe; }
        .btn-icon-action.action-edit:hover { color: #f59e0b; background: #fffbeb; border-color: #fde68a; }
        .btn-icon-action.action-restore:hover { color: #10b981; background: #ecfdf5; border-color: #a7f3d0; }
        .btn-icon-action.action-delete:hover { color: #ef4444; background: #fef2f2; border-color: #fecaca; }

        /* Esconde bot√µes de a√ß√£o para visitantes (exceto o ver) */
        body:not(.is-admin) #colabTable tbody td:last-child > *:not(:first-child) {
            display: none !important;
        }

        /* Inputs Desabilitados */
        input:disabled, select:disabled {
            background-color: #f8fafc !important; color: #94a3b8 !important;
            cursor: not-allowed; border-color: #e2e8f0 !important;
        }
   
.header-brand {
    font-size: 13px !important; /* Letra menor para igualar a 001 */
    font-weight: 700 !important;
    color: #4f46e5 !important; /* Azul exato da 001 */
    letter-spacing: 0.03em;
    text-transform: uppercase;
    display: flex;
    align-items: center;
}
	
	</style>
</head>
<body>

    <header class="top-bar">
        <div style="display: flex; align-items: center;">
            <div class="header-brand">GEST√ÉO DE COLABORADORES</div>
            <div id="viewerWarning" class="viewer-badge">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                <span>Modo Leitura</span>
            </div>
        </div>
    </header>

    <main class="container">
        
        <section id="viewList" class="content-view">
            
            <div class="actions-container">
                <div class="toolbar-left">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        <input type="text" id="searchBox" placeholder="Buscar colaborador..." onkeyup="renderizarTabela()">
                    </div>
                    <span class="counter-badge" id="contadorRegistros">Carregando...</span>
                </div>

                <div class="toolbar-right">
                    <div class="filters-group">
                        <div class="select-wrapper">
                            <select id="filtroStatus" onchange="renderizarTabela()">
                                <option value="todos">Status: Todos</option>
                                <option value="ativos">Apenas Ativos</option>
                                <option value="desligados">Desligados</option>
                            </select>
                        </div>
                        <div class="select-wrapper">
                            <select id="filtroDepto" onchange="renderizarTabela()"></select>
                        </div>
                        <div class="select-wrapper">
                            <select id="filtroCargo" onchange="renderizarTabela()"></select>
                        </div>
                    </div>
                    
                    <button class="btn-icon-soft" title="Limpar Filtros" onclick="limparFiltros()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 3L2 3 10 12.46 10 19 14 21 14 12.46 22 3"></path></svg>
                    </button>

                    <div class="vertical-divider"></div>
                    
                    <button class="btn-primary-glow admin-only" onclick="novoColaborador()">+ Novo</button>
                </div>
            </div>

            <div class="table-container">
                <div class="table-scroll-area">
                    <table id="colabTable">
                        <thead>
                            <tr>
                                <th class="sortable" onclick="ordenar('nome')">NOME <span id="sort-nome"></span></th>
                                <th class="sortable" onclick="ordenar('cargo')">CARGO <span id="sort-cargo"></span></th>
                                <th>DEPTO</th>
                                <th>ADMISS√ÉO</th>
                                <th class="sortable" onclick="ordenar('status')">STATUS <span id="sort-status"></span></th>
                                <th style="text-align: right;">A√á√ïES</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="viewForm" class="content-view" style="display: none;">
            <div class="form-header">
                <h2 id="formTitle">Novo Colaborador</h2>
                <div style="flex:1"></div>
                <div class="form-status-badge" style="display:none;" id="formStatusBadge">ATIVO</div>
            </div>

            <div class="form-tabs">
                <button class="tab-link active" onclick="openTab('tabDados', this)">Dados Pessoais</button>
                <button class="tab-link" onclick="openTab('tabContrato', this)">Contrato e Cargo</button>
                <button class="tab-link" onclick="openTab('tabDocs', this)">Documenta√ß√£o</button>
                <button class="tab-link" onclick="openTab('tabEndereco', this)">Endere√ßo e Contato</button>
                <button class="tab-link" onclick="openTab('tabBancarios', this)">Dados Banc√°rios</button>
            </div>

            <form id="mainForm" onsubmit="event.preventDefault();">
                <input type="hidden" id="colabId">
                
                <div id="tabDados" class="tab-content active">
                    <div class="grid-4">
                        <div class="field span-2"> <label>Nome Completo <span style="color:red">*</span></label> <input type="text" id="nome" required> </div>
                        <div class="field"> <label>CPF <span style="color:red">*</span></label> <input type="text" id="cpf" placeholder="000.000.000-00" required> </div>
                        <div class="field"> <label>Data Nascimento</label> <input type="date" id="dataNascimento"> </div>
                        
                        <div class="field"> <label>G√™nero</label> <select id="genero"><option value="">Selecione...</option><option>Masculino</option><option>Feminino</option><option>Outro</option></select> </div>
                        <div class="field"> <label>Estado Civil</label> <select id="estadoCivil"><option value="">Selecione...</option><option>Solteiro(a)</option><option>Casado(a)</option><option>Divorciado(a)</option></select> </div>
                        <div class="field"> <label>Nacionalidade</label> <input type="text" id="nacionalidade" value="Brasileira"> </div>
                        <div class="field"> <label>Naturalidade</label> <input type="text" id="naturalidade"> </div>

                        <div class="field"> <label>Ra√ßa/Cor</label> <select id="racaEtnia"><option value="">Selecione...</option><option>Branca</option><option>Parda</option><option>Preta</option><option>Amarela</option><option>Ind√≠gena</option></select> </div>
                        <div class="field"> <label>Grau de Instru√ß√£o</label> <select id="escolaridade"><option value="">Selecione...</option><option>M√©dio Completo</option><option>Superior Cursando</option><option>Superior Completo</option><option>P√≥s-Gradua√ß√£o</option></select> </div>
                        <div class="field span-2"> <label>Nome da M√£e</label> <input type="text" id="nomeMae"> </div>
                        
                        <div class="field span-2"> <label>Nome do Pai</label> <input type="text" id="nomePai"> </div>
                        <div class="field checkbox-wrapper" style="margin-top: 25px;">
                            <input type="checkbox" id="pcd"> <label for="pcd">Pessoa com Defici√™ncia (PCD)</label>
                        </div>
                        <div class="field checkbox-wrapper" style="margin-top: 25px;">
                            <input type="checkbox" id="candidato"> <label for="candidato">Candidato (Pr√©-Admiss√£o)</label>
                        </div>
                    </div>
                </div>

                <div id="tabContrato" class="tab-content">
                    <div class="grid-4">
                        <div class="field"> <label>Data Admiss√£o <span style="color:red">*</span></label> <input type="date" id="dataAdmissao" required> </div>
                        <div class="field"> <label>Cargo <span style="color:red">*</span></label> <select id="cargoAtualId" required></select> </div>
                        <div class="field"> <label>Departamento</label> <input type="text" id="departamento"> </div>
                        <div class="field"> <label>Matr√≠cula</label> <input type="text" id="matricula"> </div>
                        <div class="field"> <label>Tipo de Contrato</label> <select id="tipoContrato"><option>CLT Indeterminado</option><option>CLT Determinado</option><option>Est√°gio</option><option>PJ</option><option>Jovem Aprendiz</option></select> </div>
                        <div class="field"> <label>Sal√°rio Base</label> <input type="number" step="0.01" id="salario"> </div>
                        <div class="field"> <label>Moeda</label> <select id="moeda"><option>BRL</option><option>USD</option><option>EUR</option></select> </div>
                        <div class="field"> <label>Unidade/Filial</label> <input type="text" id="unidade"> </div>
                        <div class="field"> <label>Gestor Imediato</label> <select id="gestorId"></select> </div>
                        <div class="field"> <label>Email Corporativo</label> <input type="email" id="emailEmpresarial"> </div>
                        <div class="field"> <label>Turno</label> <input type="text" id="turno"> </div>
                        <div class="field"> <label>Banco de Horas?</label> <select id="bancoHoras"><option value="sim">Sim</option><option value="nao">N√£o</option></select> </div>
                    </div>
                </div>
                <div id="tabDocs" class="tab-content">
                    <div class="grid-4">
                        <div class="field"> <label>RG</label> <input type="text" id="rg"> </div>
                        <div class="field"> <label>√ìrg√£o Exp.</label> <input type="text" id="orgaoExpedidor"> </div>
                        <div class="field"> <label>Data Expedi√ß√£o</label> <input type="date" id="dataExpedicao"> </div>
                        <div class="field"> <label>PIS/PASEP</label> <input type="text" id="pis"> </div>
                        <div class="field"> <label>CTPS N¬∫</label> <input type="text" id="ctpsNum"> </div>
                        <div class="field"> <label>S√©rie CTPS</label> <input type="text" id="ctpsSerie"> </div>
                        <div class="field"> <label>T√≠tulo Eleitor</label> <input type="text" id="tituloEleitor"> </div>
                        <div class="field"> <label>Zona/Se√ß√£o</label> <input type="text" id="zonaEleitoral"> </div>
                        <div class="field"> <label>Reservista</label> <input type="text" id="reservista"> </div>
                        <div class="field"> <label>CNH</label> <input type="text" id="cnh"> </div>
                    </div>
                </div>
                <div id="tabEndereco" class="tab-content">
                    <div class="grid-4">
                        <div class="field"> <label>CEP</label> <input type="text" id="cep" onblur="buscarCep(this.value)"> </div>
                        <div class="field span-2"> <label>Logradouro</label> <input type="text" id="logradouro"> </div>
                        <div class="field"> <label>N√∫mero</label> <input type="text" id="numero"> </div>
                        <div class="field"> <label>Complemento</label> <input type="text" id="complemento"> </div>
                        <div class="field"> <label>Bairro</label> <input type="text" id="bairro"> </div>
                        <div class="field"> <label>Cidade</label> <input type="text" id="cidade"> </div>
                        <div class="field"> <label>Estado</label> <input type="text" id="estado"> </div>
                        <div class="field sep-line span-4"></div>
                        <div class="field span-2"> <label>Email Pessoal</label> <input type="email" id="emailPessoal"> </div>
                        <div class="field"> <label>Celular</label> <input type="text" id="celular"> </div>
                        <div class="field"> <label>Tel. Emerg√™ncia</label> <input type="text" id="telefoneEmergencia"> </div>
                    </div>
                </div>
                <div id="tabBancarios" class="tab-content">
                    <div class="grid-3">
                        <div class="field"> <label>Banco</label> <input type="text" id="banco"> </div>
                        <div class="field"> <label>Ag√™ncia</label> <input type="text" id="agencia"> </div>
                        <div class="field"> <label>Conta Corrente</label> <input type="text" id="contaCorrente"> </div>
                    </div>
                </div>
            </form>

            <div class="form-actions">
                <button type="button" class="btn-danger-text admin-only" id="btnExcluir" style="display:none;">Excluir</button>
                <div style="flex:1"></div>
                <button type="button" class="btn-secondary" id="btnCancelarVoltar" onclick="acaoVoltar()">Voltar</button>
                <button type="button" class="btn-primary admin-only" id="btnSalvar" onclick="salvarColaborador()">Salvar Dados</button>
                <button type="button" class="btn-primary admin-only" id="btnIrParaEdicao" style="display:none;" onclick="ativarModoEdicao()">Editar Registro</button>
            </div>
        </section>

    </main>

    <div id="modalDesligamento" class="modal-overlay" style="display: none;">
        <div class="modal-card">
            <div class="modal-header">
                <h3>Confirmar Desligamento</h3>
            </div>
            <div class="modal-body">
                <p>Voc√™ est√° prestes a desligar este colaborador.</p>
                <div class="field"><label>Data</label><input type="date" id="modalDataDemissao"></div>
                <div class="field"><label>Motivo</label><input type="text" id="modalMotivo"></div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" onclick="fecharModalDesligamento()">Cancelar</button>
                <button class="btn-danger-solid" onclick="confirmarDesligamento()">Confirmar</button>
            </div>
        </div>
    </div>  


	
	
	
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const sessionRaw = localStorage.getItem('rh_session');
            if (!sessionRaw) { window.top.location.href = '../login.html'; return; }
            const session = JSON.parse(sessionRaw);

            if (session.role === 'ADMIN') {
                document.body.classList.add('is-admin');
            } else {
                // Ativa a badge no header
                const badge = document.getElementById('viewerWarning');
                if(badge) badge.style.display = 'flex';
                
                // Trava formul√°rio
                const observer = new MutationObserver(() => {
                    const form = document.getElementById('viewForm');
                    if (form.style.display !== 'none') {
                        form.querySelectorAll('input, select, textarea').forEach(el => el.disabled = true);
                    }
                });
                observer.observe(document.getElementById('viewForm'), { attributes: true });
            }
        });
    </script>

    

    <script>
        // √çcones SVG (Feather Icons)
        const icons = {
            view: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>',
            edit: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>',
            restore: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><polyline points="23 20 23 14 17 14"></polyline><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path></svg>',
            trash: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>'
        };

        // Monitora a tabela para trocar emojis por SVGs assim que forem criados
        const tableBody = document.querySelector('#colabTable tbody');
        if (tableBody) {
            const patcher = new MutationObserver(() => {
                const buttons = tableBody.querySelectorAll('.btn-icon-action');
                buttons.forEach(btn => {
                    const html = btn.innerHTML;
                    
                    // Substitui Emoji de Olho
                    if (html.includes('üëÅÔ∏è')) {
                        btn.innerHTML = icons.view;
                        btn.classList.add('action-view');
                        btn.title = "Visualizar Ficha";
                    }
                    // Substitui Emoji de L√°pis
                    else if (html.includes('‚úèÔ∏è')) {
                        btn.innerHTML = icons.edit;
                        btn.classList.add('action-edit');
                        btn.title = "Editar Dados";
                    }
                    // Substitui Emoji de Reciclagem (Reativar)
                    else if (html.includes('‚ôªÔ∏è')) {
                        btn.innerHTML = icons.restore;
                        btn.classList.add('action-restore');
                        btn.title = "Reativar Colaborador";
                    }
                    // Substitui Emoji de Lixo (Se houver)
                    else if (html.includes('üóëÔ∏è')) {
                        btn.innerHTML = icons.trash;
                        btn.classList.add('action-delete');
                    }
                });
            });
            patcher.observe(tableBody, { childList: true, subtree: true });
        }
    </script>
</body>

<





