<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Homologação | Enterprise</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="../scripts-treinamentos/module-guard.js"></script>
    <style>
        /* [Seu CSS permanece exatamente o mesmo] */
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; outline: none; }
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; display: flex; flex-direction: column; background-color: #f1f5f9; color: #1e293b; }
        .app-header { height: 56px; flex-shrink: 0; background: #ffffff; border-bottom: 1px solid #cbd5e1; display: flex; align-items: center; padding: 0 24px; }
        .main-content { flex: 1; overflow-y: auto; padding: 24px; display: flex; flex-direction: column; align-items: center; }
        .form-card { background: white; width: 100%; max-width: 900px; border-radius: 12px; border: 1px solid #cbd5e1; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .form-section { padding: 32px; border-bottom: 1px solid #f1f5f9; }
        .section-title { font-size: 14px; font-weight: 700; color: #64748b; text-transform: uppercase; margin-bottom: 24px; display: flex; align-items: center; gap: 8px; }
        .grid-form { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
        .field-group { display: flex; flex-direction: column; gap: 8px; }
        label { font-size: 12px; font-weight: 600; color: #475569; }
        select, input { height: 42px; padding: 0 12px; border-radius: 8px; border: 1px solid #cbd5e1; font-size: 14px; transition: all 0.2s; }
        select:focus, input:focus { border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79,70,229,0.1); }
        .split-footer { padding: 20px 32px; background: #f8fafc; border-top: 1px solid #cbd5e1; display: flex; justify-content: flex-end; gap: 12px; border-radius: 0 0 12px 12px; }
        .btn { padding: 10px 24px; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; border: 1px solid transparent; }
        .btn-primary { background: #4f46e5; color: white; }
        .btn-ghost { background: transparent; color: #64748b; }
        .viewer-badge { display: none; background: #fff7ed; color: #c2410c; border: 1px solid #ffedd5; font-size: 11px; padding: 4px 12px; border-radius: 100px; }
    </style>
</head>
<body>

    <header class="app-header">
        <h1 style="font-size: 16px; font-weight: 700;">Registro de Homologação</h1>
        <div style="flex: 1;"></div>
        <div id="viewerWarning" class="viewer-badge">Modo Leitura</div>
    </header>

    <div class="main-content">
        <main class="form-card">
            
            <div class="form-section">
                <div class="section-title">Identificação do Colaborador</div>
                <div class="grid-form">
                    <div class="field-group" style="grid-column: span 2;">
                        <label>Colaborador</label>
                        <select id="selectColaborador">
                            <option value="">Carregando colaboradores...</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">Dados da Homologação</div>
                <div class="grid-form">
                    <div class="field-group" style="grid-column: span 2;">
                        <label>Treinamento / Equipamento</label>
                        <select id="selectTreinamento">
                            <option value="">Carregando treinamentos...</option>
                        </select>
                    </div>
                    
                    <div class="field-group">
                        <label>Data da Homologação</label>
                        <input type="date" id="dataHomologacao">
                    </div>

                    <div class="field-group">
                        <label>Validade (Meses)</label>
                        <select id="validadeMeses">
                            <option value="6">6 meses</option>
                            <option value="12" selected>12 meses</option>
                            <option value="24">24 meses</option>
                        </select>
                    </div>

                    <div class="field-group">
                        <label>Nota / Avaliação (0-10)</label>
                        <input type="number" id="notaTreinamento" step="0.1" min="0" max="10" placeholder="0.0">
                    </div>

                    <div class="field-group">
                        <label>Instrutor Responsável</label>
                        <input type="text" id="instrutorNome" placeholder="Nome do Instrutor">
                    </div>
                </div>
            </div>

            <footer class="split-footer">
                <button class="btn btn-ghost" onclick="history.back()">Cancelar</button>
                <button class="btn btn-primary" id="btnSubmit" onclick="registrarHomologacao()">Registrar Homologação</button>
            </footer>

        </main>
    </div>

    <script type="module" src="../scripts-treinamentos/declaracao-script.js"></script>
    
    <script>
        // Script de proteção de interface (Modo Leitura)
        document.addEventListener('DOMContentLoaded', () => {
            const sessionRaw = localStorage.getItem('rh_session');
            if (!sessionRaw) { window.top.location.href = '../login.html'; return; }
            const session = JSON.parse(sessionRaw);

            if (session.role !== 'ADMIN') {
                document.getElementById('viewerWarning').style.display = 'flex';
                document.querySelectorAll('input, select, #btnSubmit').forEach(el => el.disabled = true);
            }
        });
    </script>
</body>
</html>
